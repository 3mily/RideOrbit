<script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAzTWOeiWNOSZ611vVI1ogdOHh02Q46rug">
</script>

<h1>Map Page</h1>
<h1>Hello, <%= @user.lastname %></h1>
<h3>Select A Commute</h3>
<select onchange="calcRoute()">
<% @user.drivercommutes.each do |commute| %>
  <option value="<%= commute.id %>"><%= commute.id %></option>
<% end %>
</select>

<script type="text/javascript">
      var map;
      var directionsService = new google.maps.DirectionsService();
      var directionsDisplay;
      var drivercommutesSize = <%= @user.drivercommutes.length %>
      var drivercommutesOriginsArray = []

      function initialize() {
        directionsDisplay = new google.maps.DirectionsRenderer();
        var mapOptions = {
          center: { lat: 49.282043, lng: -123.108162},
          zoom: 13
        };
        map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);
        console.log("hello");
        
        console.log(drivercommutesSize);
        
        for(var i = 0; i < drivercommutesSize; i++){
          drivercommutesOriginsArray[i] = <%=raw @user.drivercommutes[0].origin.to_json %>;
        }

        console.log(drivercommutesOriginsArray);

      }

      function calcRoute() {
        var start = document.getElementById('start').value;
        var end = document.getElementById('end').value;
        var request = {
            origin:start,
            destination:end,
            travelMode: google.maps.TravelMode.DRIVING
        };
        directionsService.route(request, function(response, status) {
          if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(response);
          }
        });
      }
      google.maps.event.addDomListener(window, 'load', initialize);
</script>




<div id="map-canvas"></div>
